// Generated by CoffeeScript 1.6.1
(function(){var e;e={config:{maxTickerMessages:30,cities:{laval:"Laval",montreal:"Montréal",longueuil:"Longueuil",quebec:"Québec"},endpoint:"http://localhost:8080/"},socket:null,init:function(){var t,n,r,i;n=$(".resultats");r=$("#skeleton-city");for(i in this.config.cities){t=$(r.html());t.attr("data-city-id",i);t.find(".city-name").text(this.config.cities[i]);t.hide();n.append(t);t.slideDown("fast");t.attr("id","city-"+i)}this.socket=io.connect(this.config.endpoint);this.socket.on("vote",function(t){var n,i,s;i=$("#ticker");r=$("#skeleton-vote-"+t.type);n=$(r.html());if(t.type==="call"){s=t.tel.split("+").join("").substr(2);s=s.substr(0,3)+"-"+s.substr(3,3)+"-"+s.substr(6)+"xx";n.find(".tel").text(s)}n.find(".city").text(e.config.cities[t.city]);i.prepend(n.hide().fadeIn("fast"));return i.find("li:gt("+e.config.maxTickerMessages+")").remove()});return this.socket.on("stats",function(t){return e.updateVotes(t.city,t.stats.total)})},updateVotes:function(e,t){var n;n=$("#city-"+e);n.find(".vote-count").text(t).removeClass("hide");return t>=1e3?n.addClass("bignumber"):n.removeClass("bignumber")}};window.App=e;$(function(){return e.init()})}).call(this);